// Code modified/references from MultiSerial and Sweep examples.
#include <Servo.h>

// Declaring servos.
Servo servo1; //NEED TO BE ASSIGNED A FINGER.
Servo servo2; //NEED TO BE ASSIGNED A FINGER.
Servo servo3; //NEED TO BE ASSIGNED A FINGER.
Servo servo4; //NEED TO BE ASSIGNED A FINGER.
Servo servo5; //NEED TO BE ASSIGNED A FINGER.
Servo servo6; //NEED TO BE ASSIGNED WRIST.

// Servo setup values
int minPulse = 600;   // minimum servo position, us (microseconds)
int maxPulse = 2400;  // maximum servo position, us (microseconds)

// User input variables for servos and positions
int userInput[6];    // raw input from serial buffer, 3 bytes
int startbyte;       // start byte, begin reading input
int servo;           // which servo to pulse?
int pos;             // servo angle 0-180
int i;               // iterator


void setup()
{
  servo1.attach(9, minPulse, maxPulse);  // Attach each Servo object to a digital pin
  servo2.attach(3, minPulse, maxPulse);
  servo3.attach(4, minPulse, maxPulse);
  servo4.attach(5, minPulse, maxPulse);
  servo5.attach(10, minPulse, maxPulse);
  servo6.attach(11, minPulse, maxPulse);
  
  Serial.begin(9600); // Open the serial connection, 9600 BAUD
}

void loop()
{
  // Wait for serial input (min 3 bytes in buffer)
  if (Serial.available() > 2) {  // Read the first byte
    startbyte = Serial.read(); // If startbyte is received (255 sent from Python)
    if (startbyte == 255) { // Then get the next two bytes (Servo, Position)
      for (i = 0; i < 2; i++) {
        userInput[i] = Serial.read();
      }
      servo = userInput[0]; // First byte = Servo to move
      pos = userInput[1]; // Second byte = Position
      if (pos == 255) {       // Packet error checking and recovery
        servo = 255;
      }

     /* switch (servo) { // Assign new position to appropriate servo
        case 1:
          servo1.write(pos);    // move servo1 to (pos) value received from Python.
          break;
        case 2:
          servo2.write(pos);
          break;
        case 3:
          servo3.write(pos);
          break;
        case 4:
          servo4.write(pos);
          break;
        case 5:
          servo5.write(pos);
          break;
        case 6:
          servo6.write(pos);
          break;
      }*/
    }
  }
}
